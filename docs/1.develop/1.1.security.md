安全
====

后端使用`Spring Security`来保证系统安全，由于前后端分离的设计，为了保证足够简单，后端仅使用`ROLE_ADMIN`、`ROLE_USER`以及`ROLE_ANONYMOUS`三种角色，分别对应管理员、普通用户以及匿名用户。

前端登录后，可以获取账号对应的菜单和资源的权限列表，根据这些权限来渲染对应的路由菜单和操作按钮，避免未经授权的访问。同时，后端也会根据权限列表限制接口访问，阻止绕开前端的非法请求。

---

## 设计思路

安全分为认证、授权两大方面，认证即处理账号登录时的各种情况，授权即处理账号操作时的各种情况。

默认情况下，`Spring Security`内置登录页面，并且支持自定义登录页面和逻辑，以及自定义重定向相关的功能，比如错误页面、注销接口等。

由于本系统采用前后端分离的设计，前端是部署在单独的一个服务容器中，可能与后端存在不同的访问域名，因此会触发跨域限制。

虽然`vue`本身可以通过路由绕开跨域限制，但`Spring Security`内置的重定向功能，又会跳出`vue`路由的管理范围，所以我们必须进行自定义处理。

同时，不同账号应该只能访问自身具备权限的功能和数据，不能越权访问，所以要对账号进行授权。

由于前后端分离模式下，前端可以自己掌控菜单路由，因此对于菜单权限，后端仅提供数据接口，不再硬编码到配置中。对于数据权限，可以通过`spring-security-acl`框架进行控制。

这也就意味着，在后端的角色概念中，仅包含内置的匿名角色，以及正常情况下的用户角色和特殊情况下的管理员角色。

而在前端的角色概念中，可以通过后端数据动态定义非常多的类型，比如业务管理员、数据管理员、流程管理员等等，这些管理员都是大型系统中，职责分工明确的角色。

前端的每个角色对应不同的路由以及权限，路由表示各类菜单，比如导航栏菜单、侧边栏菜单以及标签菜单，而权限则对应各种资源，比如新增按钮、提交按钮、更新按钮、删除按钮等。

可以设计用户单独拥有某项权限，也可以通过角色持有多个权限，返回给前端时，需要将这些权限去重合并。

