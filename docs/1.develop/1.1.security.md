安全
====

前端使用`Router`框架，后端使用`Spring Security`框架来保证系统安全。

由于前后端分离的设计，为了保证足够简单，后端仅使用`ROLE_ADMIN`、`ROLE_USER`以及`ROLE_ANONYMOUS`三种角色，分别对应管理员、用户以及匿名人员。

前端登录后，可以获取账户对应的菜单和资源列表，通过菜单来渲染对应的路由，避免未经授权的访问。

通过资源来决定是否展示对应的操作按钮，同时，后端也会根据资源列表定义的权限标识符，对接口进行限制访问，避免非法请求。

---

## 设计思路

安全分为认证、授权两大方面，认证即处理账户登录时的各种情况，授权即处理账户操作时的各种情况。

默认情况下，`Spring Security`内置登录页面，并且支持自定义登录页面和逻辑，以及自定义重定向相关的功能，比如错误页面、注销接口等。

由于本系统采用前后端分离的设计，前端是部署在单独的一个服务容器中，可能与后端存在不同的访问域名，因此会触发跨域限制。

虽然`Vue`本身可以通过路由绕开跨域限制，但`Spring Security`内置的重定向功能，又会跳出`Vue`路由的管理范围，所以我们必须进行**自定义处理**。

另外，不同账户应该只能访问自身具备权限的功能和数据，不能越权访问，所以要对账户进行授权。

在前后端分离的模式下，前端可以自己掌控菜单路由，所以对于菜单权限，后端仅提供数据接口，不再硬编码到配置中。对于数据权限，则可以通过`spring-security-acl`框架进行控制。

这也就意味着，在后端的角色概念中，仅包含内置的匿名角色，以及正常情况下的用户角色和特殊情况下的管理员角色。

而在前端的角色概念中，可以通过后端数据动态定义非常多的类型，比如业务管理员、数据管理员、流程管理员等等，这些管理员都是大型系统中，职责分工明确的角色。

前端的每个角色对应不同的路由以及权限，路由表示各类菜单，比如顶级菜单、子级菜单，而权限则对应各种资源，比如新增按钮、提交按钮、更新按钮、删除按钮等。

为了操作上的便捷性，通常用户可以绑定一个或者多个角色，再通过角色来分配菜单和资源，这样的设计可以支撑复杂的系统权限，避免用户在重复操作中失去耐心。
